var option_hide_show=!0;function addSelect2(t,e="getOne",r="select2_ajax",a,n=null,o=null,i=1,l=250){this.search_field=a,this.table_fk=$("#"+t).attr("model"),$aaq=$("#"+t).select2({minimumInputLength:i,select_id:$(this).prop("id"),ajax:{url:r,dataType:"json",delay:l,data:function(t){return{search:t.term,model:$(this).attr("model"),field:a}},processResults:function(t){return{results:t[0]}},cache:!0},escapeMarkup:function(t){return t},templateResult:function(t){var r=$("<div><span></span><span class='"+a+"'></span></div>");return t.loading?t.text:(null!=n&&""!=n&&(r=$(n)),""==t.text&&t.id>0?$.ajax({method:"GET",url:e,data:{id:t.id,model:table_fk}}).done(function(t){return r.find("."+a).text(t[0][a]),r}):r.find("."+a).text(t[a]),r)},templateSelection:function(t){console.log(t);var r=$("<div><span></span><span class='"+a+"'></span></div>");return t.loading?t.text:(null!=o&&""!=o&&(r=$(o)),""==t.text&&t.id>0?$.ajax({method:"GET",url:e,data:{id:t.id,model:table_fk}}).done(function(t){return console.log("msg"),console.log(t),r.find("."+a).text(t[0][a]),r}):r.find("."+a).text(t[a]),r)}})}function searchTableCrud(t,e,r="tbody",a="#table-search-container"){$.ajax({method:"GET",url:t,data:e,beforeSend:function(t){$(r).append("<div class='loader'><div id='loader'></div></div>")}}).done(function(t){$(a).html(t),$(".loader").remove()}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}function get_sort_data(t,e="#table-search-container"){return""!=$(e).attr("order_field")&&""!=$("#table-search-container").attr("order")&&(t.order_field=$("#table-search-container").attr("order_field"),t.sort=$("#table-search-container").attr("order")),t}function get_serch_data(t){return console.log(getFormData(t)),getFormData(t)}$("document").ready(function(){});var crudForm=function(t){return this.crud_table_container=t,this.settings={error_class:"field-error",ajaxFileds:"login",onValided:function(t,e){"OK"!=e.messages?($("#"+t).addClass("field-error"),$("#"+t+"_error").text(e.messages),$("#"+t+"_error").addClass("animated bounceInDown")):($("#"+t).removeClass("field-error"),$("#"+t+"_error").text(""),$("#"+t+"_error").removeClass("animated bounceInDown"))},onValidedStart:function(t){console.log("onValidedStrat: "+t)},onValidedEnd:function(t){console.log("onValidedEnd: "+t)}},{setSettings:setSettings=function(t){$.map(t,function(t,e){settings[e]=t})},start:start=function(){$(crud_table_container).on("blur",".form-crud input, select, textarea",function(t){if(settings.ajaxFileds.indexOf($(this).attr("name"))>=0){var e=$(this).prop("id"),r=crud_table_container.attr("target-controller"),a={field:$(this).attr("name"),value:$(this).val()};$.ajax({method:"GET",url:"/"+r+"/ajaxField",data:a,beforeSend:function(t){settings.onValidedStart(e)}}).done(function(t){settings.onValided(e,t)}).fail(function(){console.log("OnBlur error")}).always(function(){settings.onValidedEnd(e)})}})}}};let jscrud=function(t){this.result,this.ajaxFields,this.crud_table_container=t,this.getTargetController=function(t){return"crud-table-container"==/crud-table-container/.exec(t.attr("class"))&&null!=t.attr("target-controller")?(result=t.attr("target-controller"),crud_table_container=t):getTargetController(t.parent()),result},$(crud_table_container).on("mouseenter",".order-item",function(){""==$(this).find(":nth-child(2)").attr("class")&&$(this).find(":nth-child(2)").attr("class","fa fa-sort")}),$(crud_table_container).on("mouseleave",".order-item",function(){console.log($(this).find(":nth-child(2)").attr("class")),"fa fa-sort"==$(this).find(":nth-child(2)").attr("class")&&$(this).find(":nth-child(2)").attr("class","")}),$(crud_table_container).on("click",".order-item",function(){var t=getTargetController($(this)),e=get_serch_data(crud_table_container.children(":first").next());"desc"==$(crud_table_container).attr("order")?(e.order_field=$(this).attr("order-f"),e.sort="asc",$(crud_table_container).attr("order_field",$(this).attr("order-f")),$(crud_table_container).attr("order","asc"),$(this).next().attr("class","fa fa-sort-amount-down-alt")):($(crud_table_container).attr("order"),e.order_field=$(this).attr("order-f"),e.sort="desc",$(crud_table_container).attr("order_field",$(this).attr("order-f")),$(crud_table_container).attr("order","desc")),""!=$(this).attr("order")&&searchTableCrud(page_addres+t+"?page="+$("#table-search-container").attr("page"),e,"tbody",crud_table_container)}),$(crud_table_container).on("click",".page-link",function(t){t.preventDefault();var e=-1,r=getTargetController($(this)),a=get_serch_data(crud_table_container.children(":first").next());a=get_sort_data(a),"Next »"==$(this).attr("aria-label")?($(".page-item").each(function(t){e++}),e-=1):e=$(this).html(),$(crud_table_container).attr("page",e),searchTableCrud(page_addres+r+"?page="+e,a,"tbody",crud_table_container)}),$(crud_table_container).on("click","input[type=checkbox]",function(){searchTableCrud(getTargetController($(this)),get_serch_data(crud_table_container.children(":first").next()),"tbody",crud_table_container)}),$(crud_table_container).on("change","select",function(){var t=getTargetController($(this));if(0==t)return console.log("Nie znaleziono klasy: crud-table-container lub target-controller! Uzupełnij wartosci w tagach!"),!1;var e=get_serch_data(crud_table_container.children(":first").next());console.log(e),searchTableCrud(page_addres+t,e,"tbody",crud_table_container)}),$(crud_table_container).on("keypress",".form-control",function(t){if(13==t.which){if("search-item"!=$(this).attr("role"))return!1;var e=getTargetController($(this));if(0==e)return console.log("Nie znaleziono klasy: crud-table-container lub target-controller! Uzupełnij wartosci w tagach!"),!1;var r=get_serch_data(crud_table_container.children(":first").next());searchTableCrud(page_addres+e,r,"tbody",crud_table_container)}})};
